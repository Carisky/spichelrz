{{ header }}

<div class="alert alert-danger alert-dismissible" id="error-warning">
	{{ error_warning }}</div>

<div id="account-register">
	<h1>ZAREJESTRUJ SIĘ</h1>
	<p>masz już konto<a href="index.php?route=account/login">
			zaloguj się</a>
	</p>

	<form id="form-register" action="{{ register }}" method="post" data-oc-toggle="ajax">

		<div class="form-group required custom-field">
			<div class="col-sm-10">
				<input type="text" name="firstname" value="" placeholder="{{ entry_firstname }}" id="input-firstname" class="form-control"/>
				<div id="error-firstname"></div>
			</div>
		</div>

		<div class="form-group required custom-field">
			<div class="col-sm-10">
				<input type="text" name="lastname" value="" placeholder="{{ entry_lastname }}" id="input-lastname" class="form-control"/>
				<div id="error-lastname"></div>
			</div>
		</div>

		<div class="form-group required  custom-field" data-sort="2">
			<div class="col-sm-10">
				<input type="text" name="custom_field[account][1]" value="" placeholder="Nazwa firmy" id="input-custom-field1" class="form-control">
				<div id="error-firma"></div>
			</div>
		</div>
		<div class="form-group required  custom-field" data-sort="3">
			<div class="col-sm-10">
				<input type="text" name="custom_field[account][3]" value="" placeholder="Numer NIP" id="input-custom-field3" class="form-control">
				<div id="error-nip"></div>
			</div>
		</div>
		<div class="form-group required  custom-field" data-sort="4">
			<div class="col-sm-10">
				<input type="text" name="custom_field[account][4]" value="" placeholder="Pełny adres" id="input-custom-field4" class="form-control">
				<div id="error-adres"></div>
			</div>
		</div>
		<div class="form-group required  custom-field" data-sort="5">
			<div class="col-sm-10">
				<input type="text" name="custom_field[account][6]" value="" placeholder="Miejscowość" id="input-custom-field6" class="form-control">
				<div id="error-misto"></div>
			</div>
		</div>
		<div class="form-group required  custom-field" data-sort="6">
			<div class="col-sm-10">
				<input type="text" name="custom_field[account][7]" value="" placeholder="Kod pocztowy" id="input-custom-field7" class="form-control">
				<div id="error-kod"></div>
			</div>
		</div>

		<div class="form-group required">
			<div class="col-sm-10">
				<input type="email" name="email" value="" placeholder="{{ entry_email }}" id="input-email" class="form-control"/>
				<div id="error-email"></div>
			</div>
		</div>

		<div class="form-group required">
			<div class="col-sm-10">
				<input type="tel" name="telephone" value="" placeholder="{{ entry_telephone }}" id="input-telephone" class="form-control"/>
				<div id="error-telephone"></div>
			</div>
		</div>

		<div class="form-group required">
			<div class="col-sm-10">
				<input type="password" name="password" value="" placeholder="{{ entry_password }}" id="input-password" class="form-control"/>
				<div id="error-password"></div>
			</div>
		</div>

		<div class="form-group">
			<div class="col-sm-10">
				<input type="hidden" name="newsletter" value="0"/>
				<input type="checkbox" name="newsletter" value="1" id="input-newsletter" class="form-control"/>
				<p>Newsletter</p>

			</div>
		</div>

		{{ captcha }}
		<div class="form-group required">
			{% if text_agree %}
				<div class="col-sm-10">
					<input type="checkbox" name="agree" value="1" class="form-control"/>
					<p>Przeczytałem i zgadzam się z Regulamin sklepu</p>
				</div>
			{% endif %}
		</div>
		<div class="form-group">
			<button type="submit">ZAREJESTRUJ SIĘ</button>
		</div>
	</form>

	<div>
		<a href="{{ login }}">{{ text_login_button }}</a>
	</div>
</div>

 <script>
$( "#form-register" ).on( "submit", function( event ) {
  event.preventDefault();
  $(document).find('.form-error').text('').hide();
  $.ajax({
	url: '/index.php?route=account/register/register',
	type: 'post',
	dataType: 'json',
	data: $('#form-register').serialize(),
	success: function(json) {
		$('#loader').remove();
		if(json.error) {
			$.each(json.error, function(i, v){
				$('#error-'+i).addClass('form-error').text(v).show();
			});
		} else if(json.redirect) {
			window.location.href = json.redirect;
		}
		// else {
		// 	$( "#form-register" ).trigger( "submit" ); //console.log(json);
		// }
	},
	error: function(data) {
		$('#loader').remove();
		console.log(data.responseText);
	}
  });
});

</script>

{{ footer }}
